Sub Macro1()

For x = 1 To ActiveWorkbook.Sheets.Count Step 1
  Set myrange = Sheets(x).Range("B3").CurrentRegion '
 Sheets(x).Select
 Range("A1").Select
 Set myrange = ActiveCell.CurrentRegion

row_num = myrange.Rows.Count
col_num = myrange.Columns.Count

 Dim zibianhao
    Dim drivername
    Dim xianlu As String
    Dim iftrue
    Dim xianlulist() As String
    xianlulist = Split(UserForm1.TextBox1.Text, "/")
    
For i = 4 To myrange.Rows.Count Step 1
  For j = 2 To myrange.Columns.Count Step 1
    
     iftrue = False
     drivername = myrange.Offset(i, j).Resize(1, 1).Value

        If InStr(1, drivername, "路") <> 0 Then
            xianlu = Mid(drivername, 7, InStr(1, drivername, "路") - 7)
        End If
        For t = 0 To UBound(xianlulist) Step 1
           If xianlulist(t) = xianlu Then
              iftrue = True
            End If
        Next
      If iftrue = False Then
       myrange.Offset(i, j).Resize(1, 1).Value = ""
      End If

Next
Next
Next
MsgBox "筛选完毕"
End Sub
